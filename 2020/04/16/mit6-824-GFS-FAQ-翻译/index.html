<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'å¤åˆ¶',
      copy_success: 'å¤åˆ¶æˆåŠŸ',
      copy_failure: 'å¤åˆ¶å¤±è´¥'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="mit 6.824è¯¾ç¨‹æä¾›äº†GFS FAQï¼Œæœ¬æ–‡ä¸ºç®€å•ç¿»è¯‘ã€‚">
<meta name="keywords" content="6.824,GFS">
<meta property="og:type" content="article">
<meta property="og:title" content="mit6.824-GFS-FAQ(ç¿»è¯‘)">
<meta property="og:url" content="http://yoursite.com/2020/04/16/mit6-824-GFS-FAQ-ç¿»è¯‘/index.html">
<meta property="og:site_name" content="çªè¾¹è‰">
<meta property="og:description" content="mit 6.824è¯¾ç¨‹æä¾›äº†GFS FAQï¼Œæœ¬æ–‡ä¸ºç®€å•ç¿»è¯‘ã€‚">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-04-17T03:57:00.528Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mit6.824-GFS-FAQ(ç¿»è¯‘)">
<meta name="twitter:description" content="mit 6.824è¯¾ç¨‹æä¾›äº†GFS FAQï¼Œæœ¬æ–‡ä¸ºç®€å•ç¿»è¯‘ã€‚">
  <link rel="canonical" href="http://yoursite.com/2020/04/16/mit6-824-GFS-FAQ-ç¿»è¯‘/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>mit6.824-GFS-FAQ(ç¿»è¯‘) | çªè¾¹è‰</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?859cee8f5da7a00121e9a0bef911e58c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">çªè¾¹è‰</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>å…³äº</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-commonweal">
      
    

    <a href="/404.html" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>å…¬ç›Š 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>æœç´¢</a>
      </li>
    
  </ul>

    

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="æœç´¢..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/16/mit6-824-GFS-FAQ-ç¿»è¯‘/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ChocoCLv">
      <meta itemprop="description" content="å…”å­ğŸ‡å’Œçªè¾¹è‰ğŸŒ±">
      <meta itemprop="image" content="/uploads/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="çªè¾¹è‰">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">mit6.824-GFS-FAQ(ç¿»è¯‘)

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-04-16 20:38:19" itemprop="dateCreated datePublished" datetime="2020-04-16T20:38:19+08:00">2020-04-16</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-17 11:57:00" itemprop="dateModified" datetime="2020-04-17T11:57:00+08:00">2020-04-17</time>
              </span>
            
          

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/2020/04/16/mit6-824-GFS-FAQ-ç¿»è¯‘/#comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2020/04/16/mit6-824-GFS-FAQ-ç¿»è¯‘/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>mit 6.824è¯¾ç¨‹æä¾›äº†<a href="https://pdos.csail.mit.edu/6.824/papers/gfs-faq.txt" target="_blank" rel="noopener">GFS FAQ</a>ï¼Œæœ¬æ–‡ä¸ºç®€å•ç¿»è¯‘ã€‚</p>
<a id="more"></a>
<h1 id="GFSç›¸å…³é—®é¢˜"><a href="#GFSç›¸å…³é—®é¢˜" class="headerlink" title="GFSç›¸å…³é—®é¢˜"></a>GFSç›¸å…³é—®é¢˜</h1><h2 id="ä¸ºä»€ä¹ˆåŸå­æ€§çš„è®°å½•åªä¿è¯æœ€å°‘ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯ç²¾ç¡®çš„ä¸€æ¬¡ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆåŸå­æ€§çš„è®°å½•åªä¿è¯æœ€å°‘ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯ç²¾ç¡®çš„ä¸€æ¬¡ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆåŸå­æ€§çš„è®°å½•åªä¿è¯æœ€å°‘ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯ç²¾ç¡®çš„ä¸€æ¬¡ï¼Ÿ"></a>ä¸ºä»€ä¹ˆåŸå­æ€§çš„è®°å½•åªä¿è¯æœ€å°‘ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯ç²¾ç¡®çš„ä¸€æ¬¡ï¼Ÿ</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: Why is atomic record append at-least-once, rather than exactly</span><br><span class="line">&gt; once?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>3.1èŠ‚ï¼ˆç¬¬7æ­¥ï¼‰è¯´ï¼Œå¦‚æœåœ¨å…¶ä¸­ä¸€ä¸ªå†™å…¥å¤±è´¥äºŒæ¬¡ï¼Œå®¢æˆ·ç«¯é‡è¯•å†™å…¥ã€‚ é‚£ä¼šå¯¼è‡´æ•°æ®è¦åœ¨ä¸å¤±è´¥çš„å‰¯æœ¬ä¸­å¤šæ¬¡æ·»åŠ ã€‚ ä¸åŒçš„è®¾è®¡å¯èƒ½ä¼šæ£€æµ‹åˆ°é‡å¤çš„å®¢æˆ·è¯·æ±‚ï¼Œå°½ç®¡ä»»æ„æ•…éšœï¼ˆä¾‹å¦‚ï¼ŒåŸå§‹æ•…éšœä¹‹é—´çš„ä¸»è¦æ•…éšœè¯·æ±‚å’Œå®¢æˆ·çš„é‡è¯•ï¼‰ã€‚ æ‚¨å°†åœ¨å®éªŒ3ä¸­å®ç°è¿™æ ·çš„è®¾è®¡ï¼Œåœ¨å¤æ‚æ€§å’Œæ€§èƒ½ä¸Šä»˜å‡ºç›¸å½“å¤§çš„ä»£ä»·ã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; Section 3.1, Step 7, says that if a write fails at one of the</span><br><span class="line">&gt; secondaries, the client re-tries the write. That will cause the data</span><br><span class="line">&gt; to be appended more than once at the non-failed replicas. A different</span><br><span class="line">&gt; design could probably detect duplicate client requests despite</span><br><span class="line">&gt; arbitrary failures (e.g. a primary failure between the original</span><br><span class="line">&gt; request and the client&apos;s retry). You&apos;ll implement such a design in Lab</span><br><span class="line">&gt; 3, at considerable expense in complexity and performance.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="åº”ç”¨ç¨‹åºå¦‚ä½•çŸ¥é“å—çš„å“ªäº›éƒ¨åˆ†æ˜¯paddingï¼Œå“ªäº›æ˜¯é‡å¤çš„è®°å½•"><a href="#åº”ç”¨ç¨‹åºå¦‚ä½•çŸ¥é“å—çš„å“ªäº›éƒ¨åˆ†æ˜¯paddingï¼Œå“ªäº›æ˜¯é‡å¤çš„è®°å½•" class="headerlink" title="åº”ç”¨ç¨‹åºå¦‚ä½•çŸ¥é“å—çš„å“ªäº›éƒ¨åˆ†æ˜¯paddingï¼Œå“ªäº›æ˜¯é‡å¤çš„è®°å½•"></a>åº”ç”¨ç¨‹åºå¦‚ä½•çŸ¥é“å—çš„å“ªäº›éƒ¨åˆ†æ˜¯paddingï¼Œå“ªäº›æ˜¯é‡å¤çš„è®°å½•</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: How does an application know what sections of a chunk consist of</span><br><span class="line">&gt; padding and duplicate records?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>ä¸ºäº†æ£€æµ‹å¡«å……ï¼Œåº”ç”¨ç¨‹åºåœ¨æœ‰æ•ˆè®°å½•çš„å¼€å¤´å†™å…¥å¯é¢„æµ‹çš„Magic Numberï¼Œæˆ–åŒ…å«å¯èƒ½ä¼šå‡ºç°çš„æ ¡éªŒå’Œä»…å½“è®°å½•æœ‰æ•ˆæ—¶æ‰æœ‰æ•ˆã€‚ è¯¥åº”ç”¨ç¨‹åºå¯ä»¥æ£€æµ‹é€šè¿‡åœ¨è®°å½•ä¸­åŒ…å«å”¯ä¸€IDè¿›è¡Œé‡å¤ã€‚ ç„¶åï¼Œå¦‚æœå®ƒè¯»å–ä¸€ä¸ªä¸å…ˆå‰çš„è®°å½•å…·æœ‰ç›¸åŒIDçš„è®°å½•ï¼Œå®ƒçŸ¥é“å®ƒä»¬å½¼æ­¤é‡å¤ã€‚ GFSä¸ºåº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªåº“å¤„ç†è¿™äº›æƒ…å†µã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: To detect padding, applications can put a predictable magic number</span><br><span class="line">&gt; at the start of a valid record, or include a checksum that will likely</span><br><span class="line">&gt; only be valid if the record is valid. The application can detect</span><br><span class="line">&gt; duplicates by including unique IDs in records. Then, if it reads a</span><br><span class="line">&gt; record that has the same ID as an earlier record, it knows that they</span><br><span class="line">&gt; are duplicates of each other. GFS provides a library for applications</span><br><span class="line">&gt; that handles these cases.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="ç»™å®šåŸå­è®°å½•åï¼Œå®¢æˆ·å¦‚ä½•æ‰¾åˆ°ä»–ä»¬çš„æ•°æ®ï¼Œå°†å…¶ä»¥ä¸å¯é¢„æµ‹çš„åç§»é‡å†™å…¥æ–‡ä»¶ä¸­ï¼Ÿ"><a href="#ç»™å®šåŸå­è®°å½•åï¼Œå®¢æˆ·å¦‚ä½•æ‰¾åˆ°ä»–ä»¬çš„æ•°æ®ï¼Œå°†å…¶ä»¥ä¸å¯é¢„æµ‹çš„åç§»é‡å†™å…¥æ–‡ä»¶ä¸­ï¼Ÿ" class="headerlink" title="ç»™å®šåŸå­è®°å½•åï¼Œå®¢æˆ·å¦‚ä½•æ‰¾åˆ°ä»–ä»¬çš„æ•°æ®ï¼Œå°†å…¶ä»¥ä¸å¯é¢„æµ‹çš„åç§»é‡å†™å…¥æ–‡ä»¶ä¸­ï¼Ÿ"></a>ç»™å®šåŸå­è®°å½•åï¼Œå®¢æˆ·å¦‚ä½•æ‰¾åˆ°ä»–ä»¬çš„æ•°æ®ï¼Œå°†å…¶ä»¥ä¸å¯é¢„æµ‹çš„åç§»é‡å†™å…¥æ–‡ä»¶ä¸­ï¼Ÿ</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: How can clients find their data given that atomic record append</span><br><span class="line">&gt; writes it at an unpredictable offset in the file?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: Append (and GFS in general) is mostly intended for applications</span><br><span class="line">&gt; that sequentially read entire files. Such applications will scan the</span><br><span class="line">&gt; file looking for valid records (see the previous question), so they</span><br><span class="line">&gt; don&apos;t need to know the record locations in advance. For example, the</span><br><span class="line">&gt; file might contain the set of link URLs encountered by a set of</span><br><span class="line">&gt; concurrent web crawlers. The file offset of any given URL doesn&apos;t</span><br><span class="line">&gt; matter much; readers just want to be able to read the entire set of</span><br><span class="line">&gt; URLs.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="ä»€ä¹ˆæ˜¯æ ¡éªŒå’Œ"><a href="#ä»€ä¹ˆæ˜¯æ ¡éªŒå’Œ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ ¡éªŒå’Œ"></a>ä»€ä¹ˆæ˜¯æ ¡éªŒå’Œ</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: What&apos;s a checksum?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>æ ¡éªŒå’Œç®—æ³•å°†ä¸€ä¸ªå­—èŠ‚å—ä½œä¸ºè¾“å…¥å¹¶è¿”å›ä¸€ä¸ªå•ä¸ªæ•°å­—æ˜¯æ‰€æœ‰è¾“å…¥å­—èŠ‚çš„å‡½æ•°ã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªç®€å•æ ¡éªŒå’Œå¯èƒ½æ˜¯è¾“å…¥ä¸­æ‰€æœ‰å­—èŠ‚çš„æ€»å’Œï¼ˆmodä¸€äº›å¤§æ•°å­—ï¼‰ã€‚ GFSå­˜å‚¨æ¯ä¸ªå—çš„æ ¡éªŒå’Œä»¥åŠå—ã€‚ å—æœåŠ¡å™¨åœ¨å…¶ç£ç›˜ä¸Šå†™å…¥å—æ—¶ï¼Œé¦–å…ˆè®¡ç®—æ–°å—çš„æ ¡éªŒå’Œï¼Œå¹¶å°†æ ¡éªŒå’Œä¿å­˜åœ¨ç£ç›˜ä¸Šä»¥åŠå¤§å— å½“å—æœåŠ¡å™¨ä»ç£ç›˜è¯»å–å—æ—¶ï¼Œå®ƒè¿˜è¯»å–å…ˆå‰ä¿å­˜çš„æ ¡éªŒå’Œï¼Œä»ä»ç£ç›˜è¯»å–å—ï¼Œå¹¶æ£€æŸ¥ä¸¤ä¸ªæ ¡éªŒå’Œæ˜¯å¦åŒ¹é…ã€‚ å¦‚æœæ•°æ®å·²è¢«ç£ç›˜æŸåï¼Œæ ¡éªŒå’Œä¸åŒ¹é…ï¼Œå¹¶ä¸”chunkserverå°†çŸ¥é“è¿”å›é”™è¯¯ã€‚ å¦å¤–ï¼Œä¸€äº›GFSåº”ç”¨ç¨‹åºæ ¹æ®åº”ç”¨ç¨‹åºå®šä¹‰å­˜å‚¨è‡ªå·±çš„æ ¡éªŒå’ŒGFSæ–‡ä»¶ä¸­çš„è®°å½•ï¼Œä»¥åŒºåˆ†æ­£ç¡®çš„è®°å½•å’Œå¡«å……ã€‚ CRC32æ˜¯æ ¡éªŒå’Œç®—æ³•çš„ç¤ºä¾‹ã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: A checksum algorithm takes a block of bytes as input and returns a</span><br><span class="line">&gt; single number that&apos;s a function of all the input bytes. For example, a</span><br><span class="line">&gt; simple checksum might be the sum of all the bytes in the input (mod</span><br><span class="line">&gt; some big number). GFS stores the checksum of each chunk as well as the</span><br><span class="line">&gt; chunk. When a chunkserver writes a chunk on its disk, it first</span><br><span class="line">&gt; computes the checksum of the new chunk, and saves the checksum on disk</span><br><span class="line">&gt; as well as the chunk. When a chunkserver reads a chunk from disk, it</span><br><span class="line">&gt; also reads the previously-saved checksum, re-computes a checksum from</span><br><span class="line">&gt; the chunk read from disk, and checks that the two checksums match. If</span><br><span class="line">&gt; the data was corrupted by the disk, the checksums won&apos;t match, and the</span><br><span class="line">&gt; chunkserver will know to return an error. Separately, some GFS</span><br><span class="line">&gt; applications stored their own checksums, over application-defined</span><br><span class="line">&gt; records, inside GFS files, to distinguish between correct records and</span><br><span class="line">&gt; padding. CRC32 is an example of a checksum algorithm.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="è®ºæ–‡ä¸­æåˆ°çš„å¼•ç”¨è®¡æ•°æ˜¯ä»€ä¹ˆ"><a href="#è®ºæ–‡ä¸­æåˆ°çš„å¼•ç”¨è®¡æ•°æ˜¯ä»€ä¹ˆ" class="headerlink" title="è®ºæ–‡ä¸­æåˆ°çš„å¼•ç”¨è®¡æ•°æ˜¯ä»€ä¹ˆ"></a>è®ºæ–‡ä¸­æåˆ°çš„å¼•ç”¨è®¡æ•°æ˜¯ä»€ä¹ˆ</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: The paper mentions reference counts -- what are they?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>å®ƒä»¬æ˜¯å¿«ç…§å†™æ—¶å¤åˆ¶å®ç°çš„ä¸€éƒ¨åˆ†ã€‚å½“GFSåˆ›å»ºå¿«ç…§æ—¶ï¼Œå®ƒä¸ä¼šå¤åˆ¶æ•°æ®å—ï¼Œè€Œæ˜¯å¤åˆ¶å¢åŠ æ¯ä¸ªå—çš„å‚è€ƒè®¡æ•°å™¨ã€‚ è¿™ä½¿å¾—åˆ›å»ºä¸€ä¸ªå¿«ç…§ä»·æ ¼ä¾¿å®œã€‚ å¦‚æœå®¢æˆ·å†™äº†ä¸€ä¸ªå—ï¼Œè€Œä¸»äººå†™äº†æ³¨æ„å¼•ç”¨è®¡æ•°å¤§äºä¸€ï¼Œé«˜æ‰‹åœ¨å‰åˆ¶ä½œå‰¯æœ¬ï¼Œä»¥ä¾¿å®¢æˆ·ç«¯å¯ä»¥æ›´æ–°å‰¯æœ¬ï¼ˆè€Œä¸æ˜¯å¿«ç…§çš„ä¸€éƒ¨åˆ†ï¼‰ã€‚ æ‚¨å¯ä»¥å°†å…¶è§†ä¸ºå»¶è¿Ÿå¤åˆ¶ï¼Œç›´åˆ°ç»å¯¹å¿…è¦ã€‚ å¸Œæœ›ä¸æ˜¯æ‰€æœ‰çš„å—å°†è¢«ä¿®æ”¹ï¼Œå¯ä»¥é¿å…åˆ¶ä½œä¸€äº›å‰¯æœ¬ã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: They are part of the implementation of copy-on-write for snapshots.</span><br><span class="line">&gt; When GFS creates a snapshot, it doesn&apos;t copy the chunks, but instead</span><br><span class="line">&gt; increases the reference counter of each chunk. This makes creating a</span><br><span class="line">&gt; snapshot inexpensive. If a client writes a chunk and the master</span><br><span class="line">&gt; notices the reference count is greater than one, the master first</span><br><span class="line">&gt; makes a copy so that the client can update the copy (instead of the</span><br><span class="line">&gt; chunk that is part of the snapshot). You can view this as delaying the</span><br><span class="line">&gt; copy until it is absolutely necessary. The hope is that not all chunks</span><br><span class="line">&gt; will be modified and one can avoid making some copies.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="å¦‚æœä¸€ä¸ªç¨‹åºä½¿ç”¨äº†æ ‡å‡†çš„POSIXæ–‡ä»¶æ“ä½œæ¥å£ï¼Œä¸ºäº†ä½¿ç”¨GFSï¼Œå®ƒæ˜¯å¦éœ€è¦è¿›è¡Œä¿®æ”¹"><a href="#å¦‚æœä¸€ä¸ªç¨‹åºä½¿ç”¨äº†æ ‡å‡†çš„POSIXæ–‡ä»¶æ“ä½œæ¥å£ï¼Œä¸ºäº†ä½¿ç”¨GFSï¼Œå®ƒæ˜¯å¦éœ€è¦è¿›è¡Œä¿®æ”¹" class="headerlink" title="å¦‚æœä¸€ä¸ªç¨‹åºä½¿ç”¨äº†æ ‡å‡†çš„POSIXæ–‡ä»¶æ“ä½œæ¥å£ï¼Œä¸ºäº†ä½¿ç”¨GFSï¼Œå®ƒæ˜¯å¦éœ€è¦è¿›è¡Œä¿®æ”¹"></a>å¦‚æœä¸€ä¸ªç¨‹åºä½¿ç”¨äº†æ ‡å‡†çš„POSIXæ–‡ä»¶æ“ä½œæ¥å£ï¼Œä¸ºäº†ä½¿ç”¨GFSï¼Œå®ƒæ˜¯å¦éœ€è¦è¿›è¡Œä¿®æ”¹</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: If an application uses the standard POSIX file APIs, would it need</span><br><span class="line">&gt; to be modified in order to use GFS?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>æ˜¯çš„ï¼Œä½†æ˜¯GFSä¸é€‚ç”¨äºç°æœ‰åº”ç”¨ç¨‹åºã€‚ å®ƒæ˜¯è®¾è®¡ç”¨äºæ–°ç¼–å†™çš„åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚MapReduceç¨‹åºã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: Yes, but GFS isn&apos;t intended for existing applications. It is</span><br><span class="line">&gt; designed for newly-written applications, such as MapReduce programs.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="GFSå¦‚ä½•ç¡®å®šæœ€è¿‘å‰¯æœ¬çš„ä½ç½®"><a href="#GFSå¦‚ä½•ç¡®å®šæœ€è¿‘å‰¯æœ¬çš„ä½ç½®" class="headerlink" title="GFSå¦‚ä½•ç¡®å®šæœ€è¿‘å‰¯æœ¬çš„ä½ç½®"></a>GFSå¦‚ä½•ç¡®å®šæœ€è¿‘å‰¯æœ¬çš„ä½ç½®</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: How does GFS determine the location of the nearest replica?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>æœ¬æ–‡æš—ç¤ºGFSä¼šæ ¹æ®æœåŠ¡å™¨çš„IPåœ°å€æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚å­˜å‚¨å¯ç”¨å‰¯æœ¬çš„æœåŠ¡å™¨ã€‚ åœ¨2003å¹´ï¼ŒGoogleå¿…é¡»å…·å¤‡åˆ†é…IPåœ°å€çš„æ–¹å¼ï¼Œå¦‚æœä¸¤ä¸ªIPåœ°å€æ¥è¿‘åœ¨IPåœ°å€ç©ºé—´ä¸­å½¼æ­¤è¿æ¥ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹Ÿå½¼æ­¤é è¿‘åœ¨æœºæˆ¿ã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: The paper hints that GFS does this based on the IP addresses of the</span><br><span class="line">&gt; servers storing the available replicas. In 2003, Google must have</span><br><span class="line">&gt; assigned IP addresses in such a way that if two IP addresses are close</span><br><span class="line">&gt; to each other in IP address space, then they are also close together</span><br><span class="line">&gt; in the machine room.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="å‡è®¾S1æ˜¯å—çš„Primaryï¼Œå¹¶ä¸”masterå’ŒS1ä¹‹é—´çš„ç½‘ç»œæ•…éšœã€‚-masterä¼šæ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜å¹¶æŒ‡å®šå…¶ä»–æœåŠ¡å™¨ä½œä¸ºPrimaryï¼Œæ¯”å¦‚S2ã€‚-ç”±äºS1å®é™…ä¸Šå¹¶æ²¡æœ‰å¤±è´¥ï¼Œæ‰€ä»¥ç°åœ¨åœ¨åŒä¸€ä¸ªå—ä¸­å­˜åœ¨ä¸¤ä¸ªPrimaryï¼Ÿ"><a href="#å‡è®¾S1æ˜¯å—çš„Primaryï¼Œå¹¶ä¸”masterå’ŒS1ä¹‹é—´çš„ç½‘ç»œæ•…éšœã€‚-masterä¼šæ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜å¹¶æŒ‡å®šå…¶ä»–æœåŠ¡å™¨ä½œä¸ºPrimaryï¼Œæ¯”å¦‚S2ã€‚-ç”±äºS1å®é™…ä¸Šå¹¶æ²¡æœ‰å¤±è´¥ï¼Œæ‰€ä»¥ç°åœ¨åœ¨åŒä¸€ä¸ªå—ä¸­å­˜åœ¨ä¸¤ä¸ªPrimaryï¼Ÿ" class="headerlink" title="å‡è®¾S1æ˜¯å—çš„Primaryï¼Œå¹¶ä¸”masterå’ŒS1ä¹‹é—´çš„ç½‘ç»œæ•…éšœã€‚ masterä¼šæ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜å¹¶æŒ‡å®šå…¶ä»–æœåŠ¡å™¨ä½œä¸ºPrimaryï¼Œæ¯”å¦‚S2ã€‚ ç”±äºS1å®é™…ä¸Šå¹¶æ²¡æœ‰å¤±è´¥ï¼Œæ‰€ä»¥ç°åœ¨åœ¨åŒä¸€ä¸ªå—ä¸­å­˜åœ¨ä¸¤ä¸ªPrimaryï¼Ÿ"></a>å‡è®¾S1æ˜¯å—çš„Primaryï¼Œå¹¶ä¸”masterå’ŒS1ä¹‹é—´çš„ç½‘ç»œæ•…éšœã€‚ masterä¼šæ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜å¹¶æŒ‡å®šå…¶ä»–æœåŠ¡å™¨ä½œä¸ºPrimaryï¼Œæ¯”å¦‚S2ã€‚ ç”±äºS1å®é™…ä¸Šå¹¶æ²¡æœ‰å¤±è´¥ï¼Œæ‰€ä»¥ç°åœ¨åœ¨åŒä¸€ä¸ªå—ä¸­å­˜åœ¨ä¸¤ä¸ªPrimaryï¼Ÿ</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: Suppose S1 is the primary for a chunk, and the network between the</span><br><span class="line">&gt; master and S1 fails. The master will notice and designate some other</span><br><span class="line">&gt; server as primary, say S2. Since S1 didn&apos;t actually fail, are there</span><br><span class="line">&gt; now two primaries for the same chunk?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>é‚£å°†æ˜¯ä¸€åœºç¾éš¾ï¼Œå› ä¸ºä¸¤ä¸ªPrimaryéƒ½å¯èƒ½é€‚ç”¨å¯¹åŒä¸€å—çš„ä¸åŒæ›´æ–°ã€‚ å¹¸è¿çš„æ˜¯ï¼ŒGFSçš„ç§Ÿèµæœºåˆ¶é˜²æ­¢è¿™ç§æƒ…å†µã€‚ ä¸»æœºæˆäºˆS1 60ç§’çš„ç§Ÿçº¦ã€‚ å½“ç§Ÿçº¦åˆ°æœŸæ—¶ï¼ŒS1çŸ¥é“ä¸å†æ˜¯ä¸»è¦æœåŠ¡å™¨ã€‚ masterä¸ä¼šå°†ç§Ÿçº¦æˆäºˆS2ï¼Œç›´åˆ°ä¹‹å‰çš„ç§Ÿçº¦æˆäºˆS1<br>åˆ°æœŸã€‚ å› æ­¤ï¼Œç›´åˆ°S1åœæ­¢åï¼ŒS2æ‰å¼€å§‹å……å½“ä¸»è¦å¯¹è±¡ã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: That would be a disaster, since both primaries might apply</span><br><span class="line">&gt; different updates to the same chunk. Luckily GFS&apos;s lease mechanism</span><br><span class="line">&gt; prevents this scenario. The master granted S1 a 60-second lease to be</span><br><span class="line">&gt; primary. S1 knows to stop being primary when its lease expires. The</span><br><span class="line">&gt; master won&apos;t grant a lease to S2 until the previous lease to S1</span><br><span class="line">&gt; expires. So S2 won&apos;t start acting as primary until after S1 stops.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="64MBå¯¹äºå—å¤§å°æ¥è¯´æ˜¯å¦å¤ªå¤§äº†"><a href="#64MBå¯¹äºå—å¤§å°æ¥è¯´æ˜¯å¦å¤ªå¤§äº†" class="headerlink" title="64MBå¯¹äºå—å¤§å°æ¥è¯´æ˜¯å¦å¤ªå¤§äº†"></a>64MBå¯¹äºå—å¤§å°æ¥è¯´æ˜¯å¦å¤ªå¤§äº†</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: 64 megabytes sounds awkwardly large for the chunk size!</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>64 MBçš„å—å¤§å°æ˜¯masterä¸­book-keepingçš„å•ä½ï¼Œä»¥åŠå—æœåŠ¡å™¨åˆ†ç‰‡æ–‡ä»¶çš„ç²’åº¦ã€‚ å®¢æˆ·ç«¯å¯ä»¥å‘å‡ºæ›´å°çš„è¯»å–å’Œå†™å…¥-ä»–ä»¬æ²¡æœ‰è¢«è¿«å¤„ç†æ€»å…±64 MBå—ã€‚ ä½¿ç”¨è¿™ä¹ˆå¤§çš„å—å¤§å°æ˜¯ä¸ºäº†å‡å°‘masteræ•°æ®åº“ä¸­å…ƒæ•°æ®è¡¨çš„å¤§å°ï¼Œå¹¶é¿å…é™åˆ¶æƒ³è¦è¿›è¡Œå¤§é‡ä¼ è¾“ä»¥å‡å°‘å¼€é”€çš„å®¢æˆ·ç«¯ã€‚ å¦ä¸€æ–¹é¢ï¼Œå°äº64 MBçš„æ–‡ä»¶ä¸ä¼šå¾—åˆ°å¤ªå¤šå¹¶è¡Œæ€§ã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: The 64 MB chunk size is the unit of book-keeping in the master, and</span><br><span class="line">&gt; the granularity at which files are sharded over chunkservers. Clients</span><br><span class="line">&gt; could issue smaller reads and writes -- they were not forced to deal</span><br><span class="line">&gt; in whole 64 MB chunks. The point of using such a big chunk size is to</span><br><span class="line">&gt; reduce the size of the meta-data tables in the master, and to avoid</span><br><span class="line">&gt; limiting clients that want to do huge transfers to reduce overhead. On</span><br><span class="line">&gt; the other hand, files less than 64 MB in size do not get much</span><br><span class="line">&gt; parallelism.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="Googleç°åœ¨è¿˜åœ¨ç”¨GFSå—"><a href="#Googleç°åœ¨è¿˜åœ¨ç”¨GFSå—" class="headerlink" title="Googleç°åœ¨è¿˜åœ¨ç”¨GFSå—"></a>Googleç°åœ¨è¿˜åœ¨ç”¨GFSå—</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: Does Google still use GFS?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: Rumor has it that GFS has been replaced by something called</span><br><span class="line">&gt; Colossus, with the same overall goals, but improvements in master</span><br><span class="line">&gt; performance and fault-tolerance.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="How-acceptable-is-it-that-GFS-trades-correctness-for-performance-and-simplicity"><a href="#How-acceptable-is-it-that-GFS-trades-correctness-for-performance-and-simplicity" class="headerlink" title="How acceptable is it that GFS trades correctness for performance and simplicity?"></a>How acceptable is it that GFS trades correctness for performance and simplicity?</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: How acceptable is it that GFS trades correctness for performance</span><br><span class="line">&gt; and simplicity?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: This a recurring theme in distributed systems. Strong consistency</span><br><span class="line">&gt; usually requires protocols that are complex and require chit-chat</span><br><span class="line">&gt; between machines (as we will see in the next few lectures). By</span><br><span class="line">&gt; exploiting ways that specific application classes can tolerate relaxed</span><br><span class="line">&gt; consistency, one can design systems that have good performance and</span><br><span class="line">&gt; sufficient consistency. For example, GFS optimizes for MapReduce</span><br><span class="line">&gt; applications, which need high read performance for large files and are</span><br><span class="line">&gt; OK with having holes in files, records showing up several times, and</span><br><span class="line">&gt; inconsistent reads. On the other hand, GFS would not be good for</span><br><span class="line">&gt; storing account balances at a bank.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="master-å¤±è´¥äº†ä¼šå‘ç”Ÿä»€ä¹ˆ"><a href="#master-å¤±è´¥äº†ä¼šå‘ç”Ÿä»€ä¹ˆ" class="headerlink" title="master å¤±è´¥äº†ä¼šå‘ç”Ÿä»€ä¹ˆ"></a>master å¤±è´¥äº†ä¼šå‘ç”Ÿä»€ä¹ˆ</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: What if the master fails?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>å­˜åœ¨å…·æœ‰å®Œæ•´masterçŠ¶æ€çš„å‰¯æœ¬ï¼Œè®ºæ–‡çš„è®¾è®¡ä¸­åœ¨master failåéœ€è¦è¿›è¡Œäººå·¥å¹²é¢„æ‰èƒ½åˆ‡æ¢åˆ°masterå‰¯æœ¬ï¼Œç¨åæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨Raftè‡ªåŠ¨åˆ‡æ¢ã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: There are replica masters with a full copy of the master state; the</span><br><span class="line">&gt; paper&apos;s design requires human intervention to switch to one of the</span><br><span class="line">&gt; replicas after a master failure (Section 5.1.3). We will see later how</span><br><span class="line">&gt; to build replicated services with automatic cut-over to a backup,</span><br><span class="line">&gt; using Raft.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="single-masteræ˜¯ä¸€ä¸ªå¥½çš„ä¸»æ„å—"><a href="#single-masteræ˜¯ä¸€ä¸ªå¥½çš„ä¸»æ„å—" class="headerlink" title="single masteræ˜¯ä¸€ä¸ªå¥½çš„ä¸»æ„å—"></a>single masteræ˜¯ä¸€ä¸ªå¥½çš„ä¸»æ„å—</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; Q: Did having a single master turn out to be a good idea?</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>è¿™ä¸ªæƒ³æ³•ç®€åŒ–äº†åˆå§‹åŒ–éƒ¨ç½²ï¼Œä½†ä»é•¿è¿œæ¥çœ‹å¹¶ä¸æ˜¯å¾ˆå¥½ã€‚ <a href="https://queue.acm.org/detail.cfm?id=1594206" target="_blank" rel="noopener">æœ¬æ–‡</a>è¯´ï¼Œéšç€æ—¶é—´çš„æµé€å’ŒGFSä½¿ç”¨çš„å¢åŠ ï¼Œæœ‰äº›äº‹æƒ…å‡ºäº†é—®é¢˜ã€‚ æ–‡ä»¶æ•°é‡å¢é•¿åˆ°è¶³ä»¥å°†æ‰€æœ‰æ–‡ä»¶çš„å…ƒæ•°æ®å­˜å‚¨åœ¨å•ä¸ªä¸»æœºçš„RAMä¸­æ˜¯ä¸åˆç†çš„ã€‚ å®¢æˆ·ç«¯æ•°é‡å¢é•¿åˆ°è¶³ä»¥ä½¿å•ä¸ªä¸»æœåŠ¡å™¨æ²¡æœ‰è¶³å¤Ÿçš„CPUèƒ½åŠ›ä¸ºä»–ä»¬æœåŠ¡ã€‚ ä»å‘ç”Ÿæ•…éšœçš„ä¸»æœåŠ¡å™¨åˆ‡æ¢åˆ°å…¶å¤‡ä»½ä¹‹ä¸€éœ€è¦äººå·¥å¹²é¢„ï¼Œè¿™ä½¿æ¢å¤é€Ÿåº¦å˜æ…¢ã€‚ æ˜¾ç„¶ï¼Œè°·æ­Œï¼ˆGoogleï¼‰å–ä»£äº†GFSï¼Œå³Colossusï¼Œå°†ä¸»æœåŠ¡å™¨æ‹†åˆ†ä¸ºå¤šä¸ªæœåŠ¡å™¨ï¼Œå¹¶å…·æœ‰æ›´è‡ªåŠ¨çš„ä¸»æœåŠ¡å™¨æ•…éšœæ¢å¤åŠŸèƒ½ã€‚</p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; A: That idea simplified initial deployment but was not so great in the</span><br><span class="line">&gt; long run. This article -- https://queue.acm.org/detail.cfm?id=1594206</span><br><span class="line">&gt; -- says that as the years went by and GFS use grew, a few things went</span><br><span class="line">&gt; wrong. The number of files grew enough that it wasn&apos;t reasonable to</span><br><span class="line">&gt; store all files&apos; metadata in the RAM of a single master. The number of</span><br><span class="line">&gt; clients grew enough that a single master didn&apos;t have enough CPU power</span><br><span class="line">&gt; to serve them. The fact that switching from a failed master to one of</span><br><span class="line">&gt; its backups required human intervention made recovery slow. Apparently</span><br><span class="line">&gt; Google&apos;s replacement for GFS, Colossus, splits the master over</span><br><span class="line">&gt; multiple servers, and has more automated master failure recovery.A: That idea simplified initial deployment but was not so great in the long run. This article -- https://queue.acm.org/detail.cfm?id=1594206 -- </span><br><span class="line">&gt; says that as the years went by and GFS use grew, a few things went wrong. The number of files grew enough that it wasn&apos;t reasonable to store all files&apos; metadata in the RAM of a single master. The number of clients grew enough that a single master didn&apos;t have enough CPU power</span><br><span class="line">&gt; to serve them. The fact that switching from a failed master to one of its backups required human intervention made recovery slow. Apparently Google&apos;s replacement for GFS, Colossus, splits the master over multiple servers, and has more automated master failure recovery.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></blockquote>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/6-824/" rel="tag"><i class="fa fa-tag"></i> 6.824</a>
            
              <a href="/tags/GFS/" rel="tag"><i class="fa fa-tag"></i> GFS</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2020/04/11/mit6-824-lab1-MapReduce/" rel="next" title="mit6.824-lab1-MapReduce">
                  <i class="fa fa-chevron-left"></i> mit6.824-lab1-MapReduce
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2020/04/17/vscode-remote-connect-to-Windows/" rel="prev" title="vscode-remote-connect-to-Windows">
                  vscode-remote-connect-to-Windows <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="comments"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#GFSç›¸å…³é—®é¢˜"><span class="nav-number">1.</span> <span class="nav-text">GFSç›¸å…³é—®é¢˜</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ä¸ºä»€ä¹ˆåŸå­æ€§çš„è®°å½•åªä¿è¯æœ€å°‘ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯ç²¾ç¡®çš„ä¸€æ¬¡ï¼Ÿ"><span class="nav-number">1.1.</span> <span class="nav-text">ä¸ºä»€ä¹ˆåŸå­æ€§çš„è®°å½•åªä¿è¯æœ€å°‘ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯ç²¾ç¡®çš„ä¸€æ¬¡ï¼Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åº”ç”¨ç¨‹åºå¦‚ä½•çŸ¥é“å—çš„å“ªäº›éƒ¨åˆ†æ˜¯paddingï¼Œå“ªäº›æ˜¯é‡å¤çš„è®°å½•"><span class="nav-number">1.2.</span> <span class="nav-text">åº”ç”¨ç¨‹åºå¦‚ä½•çŸ¥é“å—çš„å“ªäº›éƒ¨åˆ†æ˜¯paddingï¼Œå“ªäº›æ˜¯é‡å¤çš„è®°å½•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç»™å®šåŸå­è®°å½•åï¼Œå®¢æˆ·å¦‚ä½•æ‰¾åˆ°ä»–ä»¬çš„æ•°æ®ï¼Œå°†å…¶ä»¥ä¸å¯é¢„æµ‹çš„åç§»é‡å†™å…¥æ–‡ä»¶ä¸­ï¼Ÿ"><span class="nav-number">1.3.</span> <span class="nav-text">ç»™å®šåŸå­è®°å½•åï¼Œå®¢æˆ·å¦‚ä½•æ‰¾åˆ°ä»–ä»¬çš„æ•°æ®ï¼Œå°†å…¶ä»¥ä¸å¯é¢„æµ‹çš„åç§»é‡å†™å…¥æ–‡ä»¶ä¸­ï¼Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä»€ä¹ˆæ˜¯æ ¡éªŒå’Œ"><span class="nav-number">1.4.</span> <span class="nav-text">ä»€ä¹ˆæ˜¯æ ¡éªŒå’Œ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è®ºæ–‡ä¸­æåˆ°çš„å¼•ç”¨è®¡æ•°æ˜¯ä»€ä¹ˆ"><span class="nav-number">1.5.</span> <span class="nav-text">è®ºæ–‡ä¸­æåˆ°çš„å¼•ç”¨è®¡æ•°æ˜¯ä»€ä¹ˆ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¦‚æœä¸€ä¸ªç¨‹åºä½¿ç”¨äº†æ ‡å‡†çš„POSIXæ–‡ä»¶æ“ä½œæ¥å£ï¼Œä¸ºäº†ä½¿ç”¨GFSï¼Œå®ƒæ˜¯å¦éœ€è¦è¿›è¡Œä¿®æ”¹"><span class="nav-number">1.6.</span> <span class="nav-text">å¦‚æœä¸€ä¸ªç¨‹åºä½¿ç”¨äº†æ ‡å‡†çš„POSIXæ–‡ä»¶æ“ä½œæ¥å£ï¼Œä¸ºäº†ä½¿ç”¨GFSï¼Œå®ƒæ˜¯å¦éœ€è¦è¿›è¡Œä¿®æ”¹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GFSå¦‚ä½•ç¡®å®šæœ€è¿‘å‰¯æœ¬çš„ä½ç½®"><span class="nav-number">1.7.</span> <span class="nav-text">GFSå¦‚ä½•ç¡®å®šæœ€è¿‘å‰¯æœ¬çš„ä½ç½®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡è®¾S1æ˜¯å—çš„Primaryï¼Œå¹¶ä¸”masterå’ŒS1ä¹‹é—´çš„ç½‘ç»œæ•…éšœã€‚-masterä¼šæ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜å¹¶æŒ‡å®šå…¶ä»–æœåŠ¡å™¨ä½œä¸ºPrimaryï¼Œæ¯”å¦‚S2ã€‚-ç”±äºS1å®é™…ä¸Šå¹¶æ²¡æœ‰å¤±è´¥ï¼Œæ‰€ä»¥ç°åœ¨åœ¨åŒä¸€ä¸ªå—ä¸­å­˜åœ¨ä¸¤ä¸ªPrimaryï¼Ÿ"><span class="nav-number">1.8.</span> <span class="nav-text">å‡è®¾S1æ˜¯å—çš„Primaryï¼Œå¹¶ä¸”masterå’ŒS1ä¹‹é—´çš„ç½‘ç»œæ•…éšœã€‚ masterä¼šæ³¨æ„åˆ°è¿™ä¸ªé—®é¢˜å¹¶æŒ‡å®šå…¶ä»–æœåŠ¡å™¨ä½œä¸ºPrimaryï¼Œæ¯”å¦‚S2ã€‚ ç”±äºS1å®é™…ä¸Šå¹¶æ²¡æœ‰å¤±è´¥ï¼Œæ‰€ä»¥ç°åœ¨åœ¨åŒä¸€ä¸ªå—ä¸­å­˜åœ¨ä¸¤ä¸ªPrimaryï¼Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#64MBå¯¹äºå—å¤§å°æ¥è¯´æ˜¯å¦å¤ªå¤§äº†"><span class="nav-number">1.9.</span> <span class="nav-text">64MBå¯¹äºå—å¤§å°æ¥è¯´æ˜¯å¦å¤ªå¤§äº†</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Googleç°åœ¨è¿˜åœ¨ç”¨GFSå—"><span class="nav-number">1.10.</span> <span class="nav-text">Googleç°åœ¨è¿˜åœ¨ç”¨GFSå—</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#How-acceptable-is-it-that-GFS-trades-correctness-for-performance-and-simplicity"><span class="nav-number">1.11.</span> <span class="nav-text">How acceptable is it that GFS trades correctness for performance and simplicity?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#master-å¤±è´¥äº†ä¼šå‘ç”Ÿä»€ä¹ˆ"><span class="nav-number">1.12.</span> <span class="nav-text">master å¤±è´¥äº†ä¼šå‘ç”Ÿä»€ä¹ˆ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#single-masteræ˜¯ä¸€ä¸ªå¥½çš„ä¸»æ„å—"><span class="nav-number">1.13.</span> <span class="nav-text">single masteræ˜¯ä¸€ä¸ªå¥½çš„ä¸»æ„å—</span></a></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/uploads/avatar.jpg"
      alt="ChocoCLv">
  <p class="site-author-name" itemprop="name">ChocoCLv</p>
  <div class="site-description" itemprop="description">å…”å­ğŸ‡å’Œçªè¾¹è‰ğŸŒ±</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">36</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
        </a>
      </div>
    
  </nav>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/ChocoCLv" title="GitHub &rarr; https://github.com/ChocoCLv" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="mailto:choco_cl@163.com" title="E-Mail &rarr; mailto:choco_cl@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://yihuan18.github.io" title="https://yihuan18.github.io" rel="noopener" target="_blank">ğŸ‡</a>
        </li>
      
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 â€“ <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ChocoCLv</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.4.0</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
  
    <span class="post-meta-divider">|</span>
  
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
  
</div>












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/muse.js?v=7.4.0"></script>

<script src="/js/next-boot.js?v=7.4.0"></script>



  








  <script src="/js/local-search.js?v=7.4.0"></script>














  

  

  

  


<script>
NexT.utils.getScript('https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js', () => {
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(item => {
    return GUEST.includes(item);
  });
  new Valine({
    el: '#comments',
    verify: true,
    notify: true,
    appId: 'GwHoR7bLobe4hKkOCAWxciu9-gzGzoHsz',
    appKey: 'Jh8cJAls7JYaw9FeidM0gtVQ',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: 'zh-cn' || 'zh-cn',
    path: location.pathname
  });
}, window.Valine);
</script>

</body>
</html>
