---
title: cvte一面凉
typora-root-url: ../../source/
date: 2019-09-18 22:39:24
tags:
- 面试
---



一面就凉

<!--more-->

### cvte凉面记录

- hashmap怎么扩容

- hashmap大小为啥是2的幂

- ConcurrentHashMap的读需要加锁吗，为什么不需要加，怎么保证的，put的过程

- 线程状态有哪些，怎么进入blocked

  ![线程状态转换](/imgs/1568819525463.png)

- metaq的架构，不同模块的交互，比如跟nameserver的交互，如何保证高可用，存储结构

- metaq的消息发送过程，是否要将消息落盘

- hsf的架构，ConfigServer对比zk

  - ConfigServer强调AP，zk强调CP，但是对于注册中心而言，AP更重要。

  - zk的水平扩展能力差//TODO 为啥

  - zk对数据一致性和持久性的保障影响了性能，但是注册中心并不太关心这些，所以hsf将不需要持久化的数据存在ConfigServer中，将需要持久化的服务元数据存在redis中

  - zk使用tcp长连接的状态来判断服务状态，不一定可靠

    > 注册中心应该提供更丰富的健康监测方案，服务的健康与否的逻辑应该开放给服务提供方自己定义，而不是一刀切搞成了 TCP 活性检测！

  - zk的原生客户端在注册中心宕机时无法完成服务调用，

    > 服务调用（请求响应流）链路应该是弱依赖注册中心，必须仅在服务发布，机器上下线，服务扩缩容等必要时才依赖注册中心。

<http://jm.taobao.org/2018/06/13/%E5%81%9A%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%EF%BC%9F/>

- mysql索引命中的问题，(a,b,c)联合索引，where a=1 and b!=1 and c=1会命中索引吗
- redis持久化介绍
- 项目中tddl怎么分库分表的，cbCode怎么生成的